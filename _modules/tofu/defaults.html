<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tofu.defaults &#8212; Tofu 1.5.0</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          tofu</a>
        <span class="navbar-text navbar-version pull-left"><b>1.5.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../installation.html">Installation</a></li>
                <li><a href="../../contributing.html">Contributing</a></li>
                <li><a href="../../auto_examples/index.html">Gallery</a></li>
                <li><a href="../../aboutus.html">About</a></li>
                <li><a href="../../releases.html">Releases</a></li>
                <li><a href="../../tofu.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">How to install tofu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">A guide to contributing to tofu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/tutorials/tuto_plot_gallery_fusion_machines.html">A list of all different device configurations available (ITER, WEST, JET, ...)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Tutorials and examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu_from_bash.html">Using tofu from a bash terminal</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.html">tofu package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.geom.html">tofu.geom package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.dumpro.html">tofu.dumpro package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.data.html">tofu.data package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.dust.html">tofu.dust package</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for tofu.defaults</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module stores all the default setting of ToFu</span>
<span class="sd">Including in particular computing parameters, dictionnaries and figures</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#import matplotlib</span>
<span class="c1">#matplotlib.use(&#39;WxAgg&#39;)</span>
<span class="c1">#matplotlib.interactive(True)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#from mayavi import mlab</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dtm</span>
<span class="kn">import</span> <span class="nn">time</span> <span class="k">as</span> <span class="nn">time</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings generic</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Default saving Paths</span>
<span class="n">KeyRP</span> <span class="o">=</span> <span class="s1">&#39;/ToFu/src&#39;</span>
<span class="n">SaveAddIn</span> <span class="o">=</span> <span class="s1">&#39;/Objects_AUG/&#39;</span>
<span class="n">SaveAddObj</span> <span class="o">=</span> <span class="s1">&#39;/Objects_AUG/&#39;</span>
<span class="n">SaveAddOut</span> <span class="o">=</span> <span class="s1">&#39;/Outputs_AUG/&#39;</span>
<span class="n">MeshSaveAdd</span> <span class="o">=</span> <span class="s1">&#39;/Objects/&#39;</span>
<span class="n">dtmFormat</span> <span class="o">=</span> <span class="s2">&quot;D%Y%m</span><span class="si">%d</span><span class="s2">_T%H%M%S&quot;</span>



<span class="n">AllowedExp</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;AUG&#39;</span><span class="p">,</span><span class="s1">&#39;MISTRAL&#39;</span><span class="p">,</span><span class="s1">&#39;JET&#39;</span><span class="p">,</span><span class="s1">&#39;ITER&#39;</span><span class="p">,</span><span class="s1">&#39;TCV&#39;</span><span class="p">,</span><span class="s1">&#39;TS&#39;</span><span class="p">,</span><span class="s1">&#39;WEST&#39;</span><span class="p">,</span><span class="s1">&#39;KSTAR&#39;</span><span class="p">,</span><span class="s1">&#39;Misc&#39;</span><span class="p">,</span><span class="s1">&#39;Test&#39;</span><span class="p">]</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings of ToFu_Geom</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># ---------- Common to several classes ----------</span>

<span class="n">Legpropd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>
<span class="n">TorLegd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;frameon&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;ncol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bbox_to_anchor&#39;</span><span class="p">:(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;borderaxespad&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39;prop&#39;</span><span class="p">:</span><span class="n">Legpropd</span><span class="p">}</span>


<span class="c1">#####################################################################</span>
<span class="c1">########################  Ves class  ################################</span>
<span class="c1">#####################################################################</span>


<span class="c1"># ------------ Computing settings ---------------</span>

<span class="n">TorNP</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">TorRelOff</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">TorInsideNP</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">TorSplprms</span> <span class="o">=</span> <span class="p">[</span><span class="mf">100.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">DetBaryCylNP1</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">DetBaryCylNP2</span> <span class="o">=</span> <span class="mi">200</span>

<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">TorPd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">TorId</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">TorBsd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">TorBvd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">TorVind</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>
<span class="n">TorITord</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;dashed&#39;</span><span class="p">}</span>
<span class="n">TorBsTord</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;dashed&#39;</span><span class="p">}</span>
<span class="n">TorBvTord</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;dashed&#39;</span><span class="p">}</span>
<span class="n">TorNTheta</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">Tor3DThetalim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span>
<span class="n">Tor3DThetamin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">20.</span>
<span class="n">TorP3Dd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="s1">&#39;rstride&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;cstride&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;antialiased&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">TorPFilld</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">TorPAng</span> <span class="o">=</span> <span class="s1">&#39;theta&#39;</span>
<span class="n">TorPAngUnit</span> <span class="o">=</span> <span class="s1">&#39;rad&#39;</span>
<span class="n">TorPSketch</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">TorP3DFilld</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.4</span><span class="p">),</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>

<span class="n">Vesdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Lax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Proj</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">Elt</span><span class="o">=</span><span class="s1">&#39;PIBsBvV&#39;</span><span class="p">,</span> <span class="n">Pdict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Idict</span><span class="o">=</span><span class="n">TorId</span><span class="p">,</span> <span class="n">Bsdict</span><span class="o">=</span><span class="n">TorBsd</span><span class="p">,</span> <span class="n">Bvdict</span><span class="o">=</span><span class="n">TorBvd</span><span class="p">,</span> <span class="n">Vdict</span><span class="o">=</span><span class="n">TorVind</span><span class="p">,</span>
            <span class="n">IdictHor</span><span class="o">=</span><span class="n">TorITord</span><span class="p">,</span> <span class="n">BsdictHor</span><span class="o">=</span><span class="n">TorBsTord</span><span class="p">,</span> <span class="n">BvdictHor</span><span class="o">=</span><span class="n">TorBvTord</span><span class="p">,</span> <span class="n">Lim</span><span class="o">=</span><span class="n">Tor3DThetalim</span><span class="p">,</span> <span class="n">Nstep</span><span class="o">=</span><span class="n">TorNTheta</span><span class="p">,</span> <span class="n">LegDict</span><span class="o">=</span><span class="n">TorLegd</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># -------------- Figures ------------------------</span>


<div class="viewcode-block" id="Plot_LOSProj_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_LOSProj_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_LOSProj_DefAxes</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">Type</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">Mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Cross&#39;</span><span class="p">,</span><span class="s1">&#39;Hor&#39;</span><span class="p">,</span><span class="s1">&#39;All&#39;</span><span class="p">],</span> <span class="s2">&quot;Arg should be &#39;Cross&#39; or &#39;Hor&#39; or &#39;All&#39; !&quot;</span>
    <span class="k">assert</span> <span class="n">Type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span><span class="s1">&#39;Lin&#39;</span><span class="p">],</span> <span class="s2">&quot;Arg Type must be in [&#39;Tor&#39;,&#39;Lin&#39;] !&quot;</span>
    <span class="k">if</span> <span class="n">Mode</span> <span class="o">==</span> <span class="s1">&#39;Cross&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">8.27</span><span class="p">,</span><span class="mf">11.69</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Type</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>
    <span class="k">elif</span> <span class="n">Mode</span> <span class="o">==</span> <span class="s1">&#39;Hor&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">8.27</span><span class="p">,</span><span class="mf">11.69</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X (m)&quot;</span><span class="p">),</span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>
    <span class="k">elif</span> <span class="n">Mode</span><span class="o">==</span><span class="s1">&#39;All&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>  <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">axPosP</span><span class="p">,</span> <span class="n">axPosT</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">axP</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPosP</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">axT</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPosT</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Type</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span><span class="p">:</span>
            <span class="n">axP</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span>   <span class="n">axP</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axP</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">),</span>   <span class="n">axP</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
        <span class="n">axT</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X (m)&quot;</span><span class="p">),</span>   <span class="n">axT</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
        <span class="n">axP</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
        <span class="n">axT</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axP</span><span class="p">,</span> <span class="n">axT</span></div>

<div class="viewcode-block" id="Plot_3D_plt_Tor_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_3D_plt_Tor_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_3D_plt_Tor_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Plot_Impact_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Impact_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Impact_DefAxes</span><span class="p">(</span><span class="n">Proj</span><span class="p">,</span> <span class="n">Ang</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">AngUnit</span><span class="o">=</span><span class="s1">&#39;rad&#39;</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Sketch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">Proj</span> <span class="o">==</span> <span class="s1">&#39;Cross&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">axSketch</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">),</span> <span class="p">[]</span>
        <span class="n">XAng</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta$&quot;</span> <span class="k">if</span> <span class="n">Ang</span><span class="o">==</span><span class="s1">&#39;theta&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;$\xi$&quot;</span>
        <span class="n">XUnit</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$(rad.)$&quot;</span> <span class="k">if</span> <span class="n">AngUnit</span><span class="o">==</span><span class="s1">&#39;rad&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;$(deg.)$&quot;</span>
        <span class="n">XTickLab</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$0$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\pi/4$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\pi/2$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$3\pi/4$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\pi$&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">AngUnit</span><span class="o">==</span><span class="s1">&#39;rad&#39;</span> <span class="k">else</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$0$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$90$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$180$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$270$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$360$&quot;</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">XAng</span><span class="o">+</span><span class="sa">r</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">XUnit</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$p$ $(m)$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">XTickLab</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Sketch</span><span class="p">:</span>
            <span class="n">axSketch</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
            <span class="n">Pt</span><span class="p">,</span> <span class="n">Line</span><span class="p">,</span> <span class="n">Hor</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ksi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.8</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.6</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.7</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">ksi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="o">+</span><span class="mf">0.4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ksi</span><span class="p">),</span> <span class="mf">1.2</span><span class="o">+</span><span class="mf">0.4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ksi</span><span class="p">)])</span>
            <span class="n">axSketch</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Pt</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">Pt</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;+k&#39;</span><span class="p">,</span><span class="n">Pt</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">Pt</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;--k&#39;</span><span class="p">,</span><span class="n">Line</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">Line</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">Hor</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">Hor</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">ksi</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">ksi</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;-k&#39;</span><span class="p">)</span>
            <span class="n">axSketch</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">),</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
            <span class="n">axSketch</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\xi$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.4</span><span class="p">),</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
            <span class="n">axSketch</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$p$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.3</span><span class="p">),</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
            <span class="n">axSketch</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span> <span class="n">axSketch</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
            <span class="n">axSketch</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">axSketch</span>
    <span class="k">elif</span> <span class="n">Proj</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;3d&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">XAng</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta$&quot;</span> <span class="k">if</span> <span class="n">Ang</span><span class="o">==</span><span class="s1">&#39;theta&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;$\xi$&quot;</span>
        <span class="n">XUnit</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$(rad.)$&quot;</span> <span class="k">if</span> <span class="n">AngUnit</span><span class="o">==</span><span class="s1">&#39;rad&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;$(deg.)$&quot;</span>
        <span class="n">XTickLab</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$0$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\pi/4$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\pi/2$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$3\pi/4$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\pi$&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">AngUnit</span><span class="o">==</span><span class="s1">&#39;rad&#39;</span> <span class="k">else</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$0$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$90$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$180$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$270$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$360$&quot;</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">XAng</span><span class="o">+</span><span class="sa">r</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">XUnit</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$p$ $(m)$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\phi$ $(rad)$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">XTickLab</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ax</span><span class="p">]</span></div>

<span class="c1">#def Plot_3D_mlab_Tor_DefFig():</span>
<span class="c1">#    fW,fH,fBgC = 700,500,(1.,1.,1.)</span>
<span class="c1">#    axPosP, axPosT = [0.07, 0.1, 0.3, 0.8], [0.55, 0.1, 0.3, 0.8]</span>
<span class="c1">#    f = mlab.figure(bgcolor=fBgC,fgcolor=None,size=(fW,fH))</span>
<span class="c1">#    return f</span>



<span class="c1">#####################################################################</span>
<span class="c1">########################  Struct class  #############################</span>
<span class="c1">#####################################################################</span>


<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">StructPd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">StructP3Dd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="s1">&#39;rstride&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;cstride&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;antialiased&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>

<span class="n">Vesdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Lax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Proj</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">Elt</span><span class="o">=</span><span class="s1">&#39;PIBsBvV&#39;</span><span class="p">,</span> <span class="n">Pdict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Idict</span><span class="o">=</span><span class="n">TorId</span><span class="p">,</span> <span class="n">Bsdict</span><span class="o">=</span><span class="n">TorBsd</span><span class="p">,</span> <span class="n">Bvdict</span><span class="o">=</span><span class="n">TorBvd</span><span class="p">,</span> <span class="n">Vdict</span><span class="o">=</span><span class="n">TorVind</span><span class="p">,</span>
            <span class="n">IdictHor</span><span class="o">=</span><span class="n">TorITord</span><span class="p">,</span> <span class="n">BsdictHor</span><span class="o">=</span><span class="n">TorBsTord</span><span class="p">,</span> <span class="n">BvdictHor</span><span class="o">=</span><span class="n">TorBvTord</span><span class="p">,</span> <span class="n">Lim</span><span class="o">=</span><span class="n">Tor3DThetalim</span><span class="p">,</span> <span class="n">Nstep</span><span class="o">=</span><span class="n">TorNTheta</span><span class="p">,</span> <span class="n">LegDict</span><span class="o">=</span><span class="n">TorLegd</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>




<span class="c1">#####################################################################</span>
<span class="c1">########################  LOS class  ################################</span>
<span class="c1">#####################################################################</span>


<span class="c1"># Number of points for plotting poloidal projection as a function of PolProjAng</span>

<div class="viewcode-block" id="kpVsPolProjAng"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.kpVsPolProjAng">[docs]</a><span class="k">def</span> <span class="nf">kpVsPolProjAng</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">25.</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span></div>


<span class="c1"># ------------ Computing settings ---------------</span>
<span class="n">LOSDiscrtSLim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mi">1</span><span class="p">,)</span>
<span class="n">LOSDiscrtSLMode</span> <span class="o">=</span> <span class="s1">&#39;norm&#39;</span>
<span class="n">LOSDiscrtDS</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">LOSDiscrtSMode</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>


<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">LOSLd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">LOSMd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">LOSMImpd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">LOSLplot</span> <span class="o">=</span> <span class="s1">&#39;Tot&#39;</span>
<span class="n">LOSImpAng</span> <span class="o">=</span> <span class="s1">&#39;theta&#39;</span>
<span class="n">LOSImpAngUnit</span> <span class="o">=</span> <span class="s1">&#39;rad&#39;</span>
<span class="n">LOSImpElt</span> <span class="o">=</span> <span class="s1">&#39;LV&#39;</span>

<span class="n">LOSdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Lax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Proj</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">Lplot</span><span class="o">=</span><span class="n">LOSLplot</span><span class="p">,</span> <span class="n">Elt</span><span class="o">=</span><span class="s1">&#39;LDIORP&#39;</span><span class="p">,</span> <span class="n">EltVes</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">Leg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">Ldict</span><span class="o">=</span><span class="n">LOSLd</span><span class="p">,</span> <span class="n">MdictD</span><span class="o">=</span><span class="n">LOSMd</span><span class="p">,</span> <span class="n">MdictI</span><span class="o">=</span><span class="n">LOSMd</span><span class="p">,</span> <span class="n">MdictO</span><span class="o">=</span><span class="n">LOSMd</span><span class="p">,</span> <span class="n">MdictR</span><span class="o">=</span><span class="n">LOSMd</span><span class="p">,</span> <span class="n">MdictP</span><span class="o">=</span><span class="n">LOSMd</span><span class="p">,</span> <span class="n">LegDict</span><span class="o">=</span><span class="n">TorLegd</span><span class="p">,</span> <span class="n">Vesdict</span><span class="o">=</span><span class="n">Vesdict</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># -------------- Figures ------------------------</span>



<span class="c1">#####################################################################</span>
<span class="c1">###################### Lens class  ################################</span>
<span class="c1">#####################################################################</span>






<span class="c1"># -------------- Figures ------------------------</span>

<div class="viewcode-block" id="Plot_Lens_Alone_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Lens_Alone_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Lens_Alone_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;y (m)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>




<span class="c1">#####################################################################</span>
<span class="c1">###################### Detect class  ################################</span>
<span class="c1">#####################################################################</span>


<span class="c1"># ------------ Computing settings ---------------</span>

<span class="n">DetSpanRMinMargin</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">DetSpanNEdge</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">DetSpanNRad</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">DetConeNEdge</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">DetConeNRad</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">DetPreConedX12</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
<span class="n">DetPreConedX12Mode</span> <span class="o">=</span> <span class="s1">&#39;abs&#39;</span>
<span class="n">DetPreConeds</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">DetPreConedsMode</span> <span class="o">=</span> <span class="s1">&#39;abs&#39;</span>
<span class="n">DetPreConeMarginS</span> <span class="o">=</span> <span class="mf">0.002</span>

<span class="n">DetConeDX</span> <span class="o">=</span> <span class="mf">0.002</span>
<span class="n">DetConeDRY</span> <span class="o">=</span> <span class="mf">0.0025</span> <span class="c1"># 0.0025</span>
<span class="n">DetConeDTheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">1024.</span> <span class="c1"># 512.</span>
<span class="n">DetConeDZ</span> <span class="o">=</span> <span class="mf">0.0025</span> <span class="c1"># 0.0025</span>
<span class="c1">#DetConeNTheta = 25 # 25</span>
<span class="c1">#DetConeNZ = 50 # 50</span>

<span class="n">DetConeRefdMax</span> <span class="o">=</span> <span class="mf">0.02</span>

<span class="n">DetEtendMethod</span> <span class="o">=</span> <span class="s1">&#39;quad&#39;</span>
<span class="n">DetEtenddX12</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
<span class="n">DetEtenddX12Mode</span> <span class="o">=</span> <span class="s1">&#39;rel&#39;</span>
<span class="n">DetEtendepsrel</span> <span class="o">=</span> <span class="mf">1.e-3</span>
<span class="n">DetEtendRatio</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">DetCalcEtendColis</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">DetCalcSAngVectColis</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">DetCalcSAngVectCone</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">DetSynthEpsrel</span> <span class="o">=</span> <span class="mf">1.e-4</span>
<span class="n">DetSynthdX12</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]</span>
<span class="n">DetSynthdX12Mode</span> <span class="o">=</span> <span class="s1">&#39;abs&#39;</span>
<span class="n">DetSynthds</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">DetSynthdsMode</span> <span class="o">=</span> <span class="s1">&#39;abs&#39;</span>
<span class="n">DetSynthMarginS</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">ApPd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">}</span>
<span class="n">ApVd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">}</span>
<span class="n">DetPd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">}</span>
<span class="n">DetVd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">}</span>
<span class="n">DetSAngPld</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39;rstride&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;cstride&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;antialiased&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">}</span>
<span class="n">DetSangPlContd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;linewidths&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">}</span>
<span class="n">DetConed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolors&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;linewidths&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;linestyles&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;antialiaseds&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">DetImpd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>

<span class="n">ApLVin</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">DetSAngPlRa</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">DetSAngPldX12</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.025</span><span class="p">,</span><span class="mf">0.025</span><span class="p">]</span>
<span class="n">DetSAngPldX12Mode</span> <span class="o">=</span> <span class="s1">&#39;rel&#39;</span>
<span class="n">DetSAngPlRatio</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">DetEtendOnLOSNP</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">DetEtendOnLOSModes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;trapz&#39;</span><span class="p">]</span>
<span class="n">DetEtendOnLOSLd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>

<span class="n">DetSAngPlot</span> <span class="o">=</span> <span class="s1">&#39;Int&#39;</span>
<span class="n">DetSAngPlotMode</span> <span class="o">=</span> <span class="s1">&#39;scatter&#39;</span>
<span class="n">DetSAngPlotd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">}</span>
<span class="n">DetSAngPlotLvl</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">DetSliceAGdR</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">DetSliceAGdY</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">DetSliceAGdX</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">DetSliceAGdTheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">512.</span>
<span class="n">DetSliceAGdZ</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">DetSliceNbd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;scatter&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span>
        <span class="s1">&#39;contour&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">},</span>
        <span class="s1">&#39;contourf&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">},</span>
        <span class="s1">&#39;imshow&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">}}</span>
<span class="n">DetSliceSAd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;scatter&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span>
        <span class="s1">&#39;contour&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span>
        <span class="s1">&#39;contourf&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span>
        <span class="s1">&#39;imshow&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}}</span>


<span class="n">DetPolProjNTheta</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">DetPolProjNZ</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">DetSAngColis</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">GDetEtendMdA</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;+&#39;</span><span class="p">}</span>
<span class="n">GDetEtendMdR</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">}</span>
<span class="n">GDetEtendMdS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;o&#39;</span><span class="p">}</span>
<span class="n">GDetEtendMdP</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;*&#39;</span><span class="p">}</span>

<span class="n">GDetSigd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;+&#39;</span><span class="p">}</span>


<span class="n">Apertdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Lax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Proj</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">Elt</span><span class="o">=</span><span class="s1">&#39;PV&#39;</span><span class="p">,</span> <span class="n">EltVes</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">Leg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">LVIn</span><span class="o">=</span><span class="n">ApLVin</span><span class="p">,</span> <span class="n">Pdict</span><span class="o">=</span><span class="n">ApPd</span><span class="p">,</span> <span class="n">Vdict</span><span class="o">=</span><span class="n">ApVd</span><span class="p">,</span> <span class="n">Vesdict</span><span class="o">=</span><span class="n">Vesdict</span><span class="p">,</span> <span class="n">LegDict</span><span class="o">=</span><span class="n">TorLegd</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#Detdict =</span>


<span class="c1"># -------------- Figures ------------------------</span>

<div class="viewcode-block" id="Plot_SAng_Plane_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_SAng_Plane_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_SAng_Plane_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X1 (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X2 (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Omega$ (sr)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Plot_Etendue_AlongLOS_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Etendue_AlongLOS_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Etendue_AlongLOS_DefAxes</span><span class="p">(</span><span class="n">kMode</span><span class="o">=</span><span class="s1">&#39;rel&#39;</span><span class="p">,</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kMode</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;rel&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Rel. length (adim.)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Length (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Etendue ($sr.m^2$)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Plot_CrossSlice_SAngNb_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_CrossSlice_SAngNb_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_CrossSlice_SAngNb_DefAxes</span><span class="p">(</span><span class="n">VType</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">axSAng</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axNb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">VType</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span><span class="p">:</span>
        <span class="n">axSAng</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span>    <span class="n">axNb</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">VType</span><span class="o">==</span><span class="s1">&#39;Lin&#39;</span><span class="p">:</span>
        <span class="n">axSAng</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">),</span>    <span class="n">axNb</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
    <span class="n">axSAng</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">),</span>      <span class="n">axNb</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">axSAng</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="n">axNb</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axSAng</span><span class="p">,</span> <span class="n">axNb</span></div>


<div class="viewcode-block" id="Plot_HorSlice_SAngNb_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_HorSlice_SAngNb_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_HorSlice_SAngNb_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">axSAng</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axNb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSAng</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X (m)&quot;</span><span class="p">),</span>    <span class="n">axSAng</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
    <span class="n">axNb</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X (m)&quot;</span><span class="p">),</span>      <span class="n">axNb</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
    <span class="n">axSAng</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="n">axNb</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axSAng</span><span class="p">,</span> <span class="n">axNb</span></div>


<div class="viewcode-block" id="Plot_Etendues_GDetect_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Etendues_GDetect_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Etendues_GDetect_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.80</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Etendue (sr.m^2)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Plot_Sig_GDetect_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Sig_GDetect_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Sig_GDetect_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.80</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (W)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<span class="c1">#Ldict_mlab_Def = {&#39;color&#39;:(0.,0.,0.),&#39;tube_radius&#39;:None}</span>
<span class="c1">#Mdict_mlab_Def = {&#39;color&#39;:(0.,0.,0.),&#39;line_width&#39;:1,&#39;mode&#39;:&#39;sphere&#39;}</span>
<span class="c1">#Dict_3D_mlab_Tor_Def = {&#39;color&#39;:(0.8,0.8,0.8),&#39;opacity&#39;:0.15,&#39;transparent&#39;:False,&#39;scale_factor&#39;:0.1}</span>


<div class="viewcode-block" id="Plot_GDetect_Resolution_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_GDetect_Resolution_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_GDetect_Resolution_DefAxes</span><span class="p">(</span><span class="n">VType</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">axCol</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">X1</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span> <span class="k">if</span> <span class="n">VType</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;size (a.u.)&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Channels index (from 0)&quot;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span></div>











<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings of ToFu_Mesh</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Computing</span>

<span class="n">BF2IntMode</span> <span class="o">=</span> <span class="s1">&#39;Surf&#39;</span>

<span class="n">Mesh1DDefName</span> <span class="o">=</span> <span class="s1">&#39;NoName&#39;</span>
<span class="n">Mesh2DDefName</span> <span class="o">=</span> <span class="s1">&#39;NoName&#39;</span>

<span class="n">L1DRes</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">L1Mode</span> <span class="o">=</span> <span class="s1">&#39;Larger&#39;</span>
<span class="n">L1Tol</span> <span class="o">=</span> <span class="mf">1e-14</span>

<span class="n">L1IntOpSpa</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">L1IntOpSpaFormat</span> <span class="o">=</span> <span class="s1">&#39;dia&#39;</span>


<div class="viewcode-block" id="BF2_DVect_DefR"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.BF2_DVect_DefR">[docs]</a><span class="k">def</span> <span class="nf">BF2_DVect_DefR</span><span class="p">(</span><span class="n">Points</span><span class="p">):</span>
    <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">Points</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],))])</span></div>

<div class="viewcode-block" id="BF2_DVect_DefZ"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.BF2_DVect_DefZ">[docs]</a><span class="k">def</span> <span class="nf">BF2_DVect_DefZ</span><span class="p">(</span><span class="n">Points</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">]])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">Points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="BF2_DVect_DefTor"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.BF2_DVect_DefTor">[docs]</a><span class="k">def</span> <span class="nf">BF2_DVect_DefTor</span><span class="p">(</span><span class="n">Points</span><span class="p">):</span>
    <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">Points</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],))])</span></div>



<span class="c1"># --- Plotting dictionaries and parameters ------</span>


<span class="n">Legpropd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>
<span class="n">M2Legd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;frameon&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;ncol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bbox_to_anchor&#39;</span><span class="p">:(</span><span class="mf">1.22</span><span class="p">,</span> <span class="mf">1.12</span><span class="p">),</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;borderaxespad&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;prop&#39;</span><span class="p">:</span><span class="n">Legpropd</span><span class="p">}</span>

<span class="n">M1Kd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">3.</span><span class="p">}</span>
<span class="n">M1Cd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">}</span>
<span class="n">M1Resd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">2.</span><span class="p">}</span>

<span class="n">M2Bckd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.9</span><span class="p">),</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">}</span>
<span class="n">M2Mshd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">}</span>
<span class="n">M2Kd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mf">2.</span><span class="p">}</span>
<span class="n">M2Cd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">}</span>
<span class="n">M2Sd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span>

<span class="n">BF1Sub</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">BF1SubMode</span> <span class="o">=</span> <span class="s1">&#39;rel&#39;</span>
<span class="n">BF1Fd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">}</span>
<span class="n">BF1Totd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">}</span>

<span class="n">BF2Sub</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">BF2SubMode</span> <span class="o">=</span> <span class="s1">&#39;rel&#39;</span>

<span class="n">BF2PlotMode</span> <span class="o">=</span> <span class="s1">&#39;contourf&#39;</span>
<span class="n">BF2PlotSubP</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">BF2PlotSubMode</span> <span class="o">=</span> <span class="s1">&#39;rel&#39;</span>
<span class="n">BF2PlotNC</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">BF2PlotTotd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span>
<span class="n">BF2PlotIndSd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">BF2PlotIndPd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mf">2.</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="s1">&#39;none&#39;</span><span class="p">}</span>



<span class="c1"># -------------- Figures ------------------------</span>


<div class="viewcode-block" id="Plot_Mesh1D_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Mesh1D_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Mesh1D_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X (m)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="Plot_Res_Mesh1D_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Res_Mesh1D_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Res_Mesh1D_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;X (m)&quot;</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta$ X (m)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="Plot_Mesh2D_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Mesh2D_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Mesh2D_DefAxes</span><span class="p">(</span><span class="n">VType</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.68</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">Xlab</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span> <span class="k">if</span> <span class="n">VType</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">Xlab</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="Plot_Res_Mesh2D_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Res_Mesh2D_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Res_Mesh2D_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">VType</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">):</span>
    <span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axPos1</span><span class="p">,</span> <span class="n">axPos2</span><span class="p">,</span> <span class="n">axPos3</span><span class="p">,</span> <span class="n">axPoscb</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos2</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos3</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axcb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPoscb</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">X1str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span> <span class="k">if</span> <span class="n">VType</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">X1str</span><span class="p">),</span>          <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Res. (m)&quot;</span><span class="p">),</span>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">),</span>            <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Res. (m)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">axcb</span></div>









<div class="viewcode-block" id="Plot_BSpline_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_BSpline_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_BSpline_DefAxes</span><span class="p">(</span><span class="n">Mode</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">Mode</span><span class="o">==</span><span class="s1">&#39;1D&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
        <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$X$ ($m$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Y$ ($a.u.$)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>
    <span class="k">elif</span> <span class="n">Mode</span><span class="o">==</span><span class="s1">&#39;2D&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
        <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$R$ ($m$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Z$ ($m$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>
    <span class="k">elif</span> <span class="n">Mode</span><span class="o">==</span><span class="s1">&#39;3D&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
        <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$R$ ($m$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Z$ ($m$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Emiss. (a.u.)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Plot_BSplineFit_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_BSplineFit_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_BSplineFit_DefAxes</span><span class="p">(</span><span class="n">Mode</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">Mode</span><span class="o">==</span><span class="s1">&#39;2D&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
        <span class="n">axPos1</span><span class="p">,</span> <span class="n">axPos2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos2</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$R$ ($m$)&quot;</span><span class="p">),</span>   <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Z$ ($m$)&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$R$ ($m$)&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">),</span>          <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span>
    <span class="k">elif</span> <span class="n">Mode</span><span class="o">==</span><span class="s1">&#39;3D&#39;</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
        <span class="n">axPos1</span><span class="p">,</span> <span class="n">axPos2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos1</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos2</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$R$ $(m)$&quot;</span><span class="p">),</span>           <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Z$ $(m)$&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$R$ $(m)$&quot;</span><span class="p">),</span>           <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Z$ $(m)$&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Emiss.$ $(a.u.)$&quot;</span><span class="p">),</span>   <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Emiss.$ $(a.u.)$&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span></div>



<div class="viewcode-block" id="Plot_BSpline_Deriv_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_BSpline_Deriv_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_BSpline_Deriv_DefAxes</span><span class="p">(</span><span class="n">Deg</span><span class="p">):</span>
    <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Deg</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">Deg</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;x (a.u.)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$d^{&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;}$ (a.u.)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Plot_BaseFunc2D_BFuncMesh_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_BaseFunc2D_BFuncMesh_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_BaseFunc2D_BFuncMesh_DefAxes</span><span class="p">():</span>
    <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="n">axPos1</span><span class="p">,</span> <span class="n">axPos2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos2</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (a.u.)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span></div>


<div class="viewcode-block" id="Plot_BFunc_SuppMax_PolProj_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_BFunc_SuppMax_PolProj_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_BFunc_SuppMax_PolProj_DefAxes</span><span class="p">():</span>
    <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="Plot_BF2_interp_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_BF2_interp_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_BF2_interp_DefAxes</span><span class="p">():</span>
    <span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="n">axPosV1</span><span class="p">,</span> <span class="n">axPosC1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">axV1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPosV1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axC1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPosC1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axV1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span> <span class="n">axC1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">)</span>
    <span class="n">axV1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">),</span> <span class="n">axC1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">axV1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Input&quot;</span><span class="p">),</span> <span class="n">axC1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Output&quot;</span><span class="p">)</span>
    <span class="n">axV1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">),</span> <span class="n">axC1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axV1</span><span class="p">,</span> <span class="n">axC1</span></div>












<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings of tofu.Eq</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">Eq2DPlotDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;scatter&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span>
        <span class="s1">&#39;contour&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">},</span>
        <span class="s1">&#39;contourf&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">},</span>
        <span class="s1">&#39;imshow&#39;</span><span class="p">:{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">}}</span>
<span class="n">Eq2DMagAxDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;ms&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;mew&#39;</span><span class="p">:</span><span class="mf">2.</span><span class="p">}</span>
<span class="n">Eq2DSepDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">}</span>

<span class="n">Eq2DPlotRadDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pivot&#39;</span><span class="p">:</span><span class="s1">&#39;tail&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;angles&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;scale_units&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.003</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headlength&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>
<span class="n">Eq2DPlotPolDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pivot&#39;</span><span class="p">:</span><span class="s1">&#39;tail&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;angles&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;scale_units&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.003</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headlength&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>

<span class="n">Eq2DPlotVsDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;ms&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;mec&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">}</span>


<span class="c1"># -------------- Figures ------------------------</span>



<div class="viewcode-block" id="Plot_Eq2D_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Eq2D_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Eq2D_DefAxes</span><span class="p">(</span><span class="n">VType</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">8.27</span><span class="p">,</span><span class="mf">11.69</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.68</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.82</span><span class="p">,</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.60</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span> <span class="k">if</span> <span class="n">cbar</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">Xlab</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span> <span class="k">if</span> <span class="n">VType</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">Xlab</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">axc</span></div>


<div class="viewcode-block" id="Plot_Eq2D_Vs_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Eq2D_Vs_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Eq2D_Vs_DefAxes</span><span class="p">(</span><span class="n">VType</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>




<div class="viewcode-block" id="Plot_Eq2D_Inter_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Eq2D_Inter_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Eq2D_Inter_DefAxes</span><span class="p">(</span><span class="n">VType</span><span class="o">=</span><span class="s1">&#39;Tor&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">16.</span><span class="p">,</span><span class="mf">11.3</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.60</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span> <span class="k">if</span> <span class="n">cbar</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="n">Xlab</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span> <span class="k">if</span> <span class="n">VType</span><span class="o">==</span><span class="s1">&#39;Tor&#39;</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;Y (m)&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">Xlab</span><span class="p">),</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">Xlab</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;2DProf&#39;</span><span class="p">:[</span><span class="n">ax1</span><span class="p">],</span> <span class="s1">&#39;1DProf&#39;</span><span class="p">:[</span><span class="n">ax2</span><span class="p">],</span> <span class="s1">&#39;1DTime&#39;</span><span class="p">:[</span><span class="n">ax3</span><span class="p">],</span> <span class="s1">&#39;Misc&#39;</span><span class="p">:[</span><span class="n">axc</span><span class="p">],</span> <span class="s1">&#39;1DConst&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;2DConst&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span></div>











<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings of ToFu_MatComp</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># ------------ Computing settings ---------------</span>

<span class="n">GMindMSubP</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">GMindMSubPMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>
<span class="n">GMindMSubTheta</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">GMindMSubThetaMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>

<span class="n">GMMatMSubP</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">GMMatMSubPMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>
<span class="n">GMMatMSubTheta</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">GMMatMSubThetaMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>
<span class="n">GMMatepsrel</span> <span class="o">=</span> <span class="mf">1.e-4</span>
<span class="n">GMMatMode</span> <span class="o">=</span> <span class="s1">&#39;trapz&#39;</span>
<span class="n">GMMatDMinInf</span> <span class="o">=</span> <span class="mf">0.0005</span>

<span class="n">GMMatLOSMode</span> <span class="o">=</span> <span class="s1">&#39;quad&#39;</span>
<span class="n">GMMatLOSeps</span> <span class="o">=</span> <span class="mf">1.e-4</span>
<span class="n">GMMatLOSSubP</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">GMMatLOSSubPMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>

<span class="n">GMSigPlotSubP</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">GMSigPlotSubPMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>
<span class="n">GMSigPlotNC</span> <span class="o">=</span> <span class="mi">30</span>


<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">GMPlotDetSubP</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">GMPlotDetSubPMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>
<span class="n">GMPlotDetKWArgMesh</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Elt&#39;</span><span class="p">:</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;Mshdict&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.9</span><span class="p">),</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">,</span><span class="s1">&#39;zorder&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">}}</span><span class="c1">#&#39;MBKC&#39;</span>
<span class="n">GMPlotDetKWArgTor</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Elt&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">}</span>
<span class="n">GMPlotDetKWArgDet</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Elt&#39;</span><span class="p">:</span><span class="s1">&#39;PC&#39;</span><span class="p">,</span> <span class="s1">&#39;EltApert&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;EltLOS&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;EltTor&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">}</span>


<span class="n">GMPlotBFDetd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Elt&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;Conedict&#39;</span><span class="p">:{</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">:</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="s1">&#39;facecolors&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="s1">&#39;linewidths&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39;zorder&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span><span class="s1">&#39;EltLOS&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;Ldict&#39;</span><span class="p">:{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;zorder&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">}}</span>

<span class="n">GMPlotBFSubP</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">GMPlotBFSubPMode</span> <span class="o">=</span> <span class="s1">&#39;Rel&#39;</span>
<span class="n">GMPlotBFKWArgLOS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Elt&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">}</span>

<span class="n">GMPlotDetCd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">:</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="s1">&#39;linewidths&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">}</span>
<span class="n">GMPlotDetLd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">}</span>
<span class="n">GMPlotDetLOSd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">}</span>

<span class="n">GMSigPlotSd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">GMSigPlotSLOSd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Elt&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;Ldict&#39;</span><span class="p">:{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
<span class="n">GMSigPlotCd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">}</span> <span class="c1"># or gray_r or Greys or hot_r</span>


<span class="c1"># -------------- Figures ------------------------</span>


<div class="viewcode-block" id="Plot_GeomMatrix_Mesh_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_GeomMatrix_Mesh_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_GeomMatrix_Mesh_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">axPos1</span><span class="p">,</span> <span class="n">axPos2</span><span class="p">,</span> <span class="n">axPos3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos2</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos3</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Mesh elements index (starts at 0)&quot;</span><span class="p">),</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Basis functions index (starts at 0)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Contribution ($W/sr/m^3 x sr.m^3$)&quot;</span><span class="p">),</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Contribution $W/sr/m^3 x sr.m^3$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span></div>


<div class="viewcode-block" id="Plot_BF2_sum_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_BF2_sum_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_BF2_sum_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">axPos1</span><span class="p">,</span> <span class="n">axPos2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos2</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Detect index (starts at 0)&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;BFunc index (starts at 0)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Contribution ($sr.m^3$)&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Contribution ($sr.m^3$)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span></div>


<div class="viewcode-block" id="Plot_SynDiag_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_SynDiag_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_SynDiag_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">axPos1</span><span class="p">,</span> <span class="n">axPos2</span><span class="p">,</span> <span class="n">axPos3</span><span class="p">,</span> <span class="n">axPos4</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos2</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos3</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axPos4</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">),</span> <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SXR (W)&quot;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span><span class="c1">#, ax3.set_ylabel(r&quot;Z (m)&quot;), ax4.set_ylabel(r&quot;Z (m)&quot;)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">),</span> <span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">),</span> <span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span></div>




<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings of ToFu_Treat</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>



<div class="viewcode-block" id="Plot_TreatSig_Def"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_TreatSig_Def">[docs]</a><span class="k">def</span> <span class="nf">Plot_TreatSig_Def</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nMax</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax3D</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axtime</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axprof</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">LaxTxtChan</span><span class="p">,</span> <span class="n">LaxTxtTime</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.40</span><span class="o">-</span><span class="mf">0.13</span><span class="p">)</span><span class="o">/</span><span class="n">nMax</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.98</span><span class="o">-</span><span class="mf">0.45</span><span class="p">)</span><span class="o">/</span><span class="n">nMax</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nMax</span><span class="p">):</span>
        <span class="n">LaxTxtChan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.13</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="n">width</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
        <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span>    <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span>  <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span>                      <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>                       <span class="n">LaxTxtChan</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">LaxTxtTime</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.45</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
        <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span>    <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span>  <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span>                      <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>                       <span class="n">LaxTxtTime</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax3D</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">),</span> <span class="n">ax3D</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Channel index&quot;</span><span class="p">)</span>
    <span class="n">axtime</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">),</span> <span class="n">axtime</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SXR Mes. (mW)&quot;</span><span class="p">)</span>
    <span class="n">axprof</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Channel index&quot;</span><span class="p">),</span> <span class="n">axprof</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SXR Mes. (mW)&quot;</span><span class="p">)</span>
    <span class="n">axtime</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">axprof</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax3D</span><span class="p">,</span> <span class="n">axtime</span><span class="p">,</span> <span class="n">axprof</span><span class="p">,</span> <span class="n">LaxTxtChan</span><span class="p">,</span> <span class="n">LaxTxtTime</span></div>

<div class="viewcode-block" id="Plot_Noise_Def"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Noise_Def">[docs]</a><span class="k">def</span> <span class="nf">Plot_Noise_Def</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Phys. (a.u.)&quot;</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Noise (a.u.)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Plot_FFTChan_Def"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_FFTChan_Def">[docs]</a><span class="k">def</span> <span class="nf">Plot_FFTChan_Def</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>



<div class="viewcode-block" id="Plot_FFTInter_Def"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_FFTInter_Def">[docs]</a><span class="k">def</span> <span class="nf">Plot_FFTInter_Def</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mf">11.3</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">ax21</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax22</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axt</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axF</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">ax21</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">),</span> <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pow. spectrum norm. to max&quot;</span><span class="p">)</span>
    <span class="n">ax22</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">),</span>   <span class="n">ax22</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">),</span> <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pow. spectrum norm. to instantaneous max&quot;</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">),</span>    <span class="n">axt</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Harm. magnitude$^2$ (a.u.)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">),</span>    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Harm. magnitude$^2$ (a.u.)&quot;</span><span class="p">)</span>
    <span class="n">ax21</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">ax22</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">axt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">axF</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax21</span><span class="p">,</span> <span class="n">ax22</span><span class="p">,</span> <span class="n">axt</span><span class="p">,</span> <span class="n">axF</span></div>






<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings of ToFu_Inv</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>




<span class="c1"># Probability law for augmented tikho : p(x) = x^(a-1)*exp(-bx)</span>
<span class="c1"># If normalised :</span>
<span class="c1">#       Mean [x]        a / b</span>
<span class="c1">#       Variance &lt;x&gt;    a / b^2</span>
<span class="c1"># If not normalised :</span>
<span class="c1">#       Mean [x]        a! / (b^(a+1))</span>
<span class="c1">#       Variance &lt;x&gt;    a!/b^(2a+2) * ( (a+1)b^a - a! )</span>
<span class="c1">#       [x] = k     =&gt;  b = (a!/k)^(1/(a+1))</span>
<span class="c1">#       if [x]=1    =&gt;  &lt;x&gt; = (a+1)* (a!)^(1/(a+1)) - 1</span>


<span class="n">ConvCrit</span> <span class="o">=</span> <span class="mf">1.e-6</span>
<span class="n">chi2Tol</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">chi2Obj</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">mu0</span> <span class="o">=</span> <span class="mf">1000.</span>


<span class="n">AugTikho_a0</span> <span class="o">=</span> <span class="mi">10</span>                                                    <span class="c1"># (Regul. parameter, larger a =&gt; larger variance)</span>
<span class="n">AugTikho_b0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">AugTikho_a0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">AugTikho_a0</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>   <span class="c1"># To have [x] = 1</span>
<span class="n">AugTikho_a1</span> <span class="o">=</span> <span class="mi">2</span>                                                     <span class="c1"># (Noise), a as small as possible for small variance</span>
<span class="n">AugTikho_b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">AugTikho_a1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">AugTikho_a1</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>   <span class="c1"># To have [x] = 1</span>
<span class="n">AugTikho_d</span> <span class="o">=</span> <span class="mf">0.95</span>                                                   <span class="c1"># Exponent for rescaling of a0bis in V2, typically in [1/3 ; 1/2], but real limits are 0 &lt; d &lt; 1 (or 2 ?)</span>

<span class="n">AugTkLsmrAtol</span> <span class="o">=</span> <span class="mf">1.e-8</span>
<span class="n">AugTkLsmrBtol</span> <span class="o">=</span> <span class="mf">1.e-8</span>
<span class="n">AugTkLsmrConlim</span> <span class="o">=</span> <span class="mf">1e8</span>
<span class="n">AugTkLsmrMaxiter</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">SolInvParDef</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Dt&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;mu0&#39;</span><span class="p">:</span><span class="n">mu0</span><span class="p">,</span><span class="s1">&#39;SolMethod&#39;</span><span class="p">:</span><span class="s1">&#39;InvLin_AugTikho_V1&#39;</span><span class="p">,</span><span class="s1">&#39;Deriv&#39;</span><span class="p">:</span><span class="s1">&#39;D2N2&#39;</span><span class="p">,</span><span class="s1">&#39;IntMode&#39;</span><span class="p">:</span><span class="s1">&#39;Vol&#39;</span><span class="p">,</span><span class="s1">&#39;Cond&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;ConvCrit&#39;</span><span class="p">:</span><span class="n">ConvCrit</span><span class="p">,</span><span class="s1">&#39;Sparse&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;SpType&#39;</span><span class="p">:</span><span class="s1">&#39;csr&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">:{</span><span class="s1">&#39;In&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;NLim&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span> <span class="s1">&#39;Pos&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;KWARGS&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="n">AugTikho_a0</span><span class="p">,</span> <span class="s1">&#39;b0&#39;</span><span class="p">:</span><span class="n">AugTikho_b0</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">:</span><span class="n">AugTikho_a1</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">:</span><span class="n">AugTikho_b1</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="n">AugTikho_d</span><span class="p">,</span> <span class="s1">&#39;ConvReg&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;FixedNb&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">},</span> <span class="s1">&#39;timeit&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Verb&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;VerbNb&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;Method&#39;</span><span class="p">:</span><span class="s1">&#39;Poly&#39;</span><span class="p">,</span><span class="s1">&#39;Deg&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Group&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;plot&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;LNames&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;Com&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>


<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">InvPlotSubP</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">InvPlotSubMode</span> <span class="o">=</span> <span class="s1">&#39;abs&#39;</span>

<span class="n">InvAnimIntervalms</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">InvAnimBlit</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">InvAnimRepeat</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">InvAnimRepeatDelay</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">InvAnimTimeScale</span> <span class="o">=</span> <span class="mf">1.e2</span>

<span class="n">InvPlotF</span> <span class="o">=</span> <span class="s1">&#39;imshow&#39;</span>
<span class="n">InvLvls</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">Invdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span>
<span class="n">Tempd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">}</span>
<span class="n">Retrod</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">}</span>
<span class="n">InvSXRd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">}</span>
<span class="n">InvSigmad</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">),</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">}</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># -------------- Figures ------------------------</span>

<div class="viewcode-block" id="Plot_Inv_Anim_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_Anim_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_Anim_DefAxes</span><span class="p">(</span><span class="n">SXR</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">TMat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Chi2N</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Mu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Nit</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">SXR</span><span class="p">,</span><span class="n">TMat</span><span class="p">,</span><span class="n">Chi2N</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Nit</span><span class="p">]):</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span><span class="mi">10</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">axInvPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">]</span>
        <span class="n">axcPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]</span>
        <span class="n">axTMat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">tempPos</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">elif</span> <span class="n">SXR</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">TMat</span><span class="p">,</span><span class="n">Chi2N</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Nit</span><span class="p">]):</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span><span class="mi">12</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">axInvPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">]</span>
        <span class="n">axcPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">]</span>
        <span class="n">tempPos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]]</span>
        <span class="n">tempylab</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span><span class="p">]</span>
        <span class="n">axTMat</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">elif</span> <span class="n">SXR</span> <span class="ow">and</span> <span class="n">TMat</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">Chi2N</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Nit</span><span class="p">]):</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span><span class="mi">10</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">axInvPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">]</span>
        <span class="n">axcPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]</span>
        <span class="n">tempPos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">]]</span>
        <span class="n">tempylab</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span><span class="p">]</span>
        <span class="n">TMatPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">]</span>
        <span class="n">TMatylab</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span>

    <span class="k">elif</span> <span class="ow">not</span> <span class="n">SXR</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">Chi2N</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Nit</span><span class="p">]):</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span><span class="mi">10</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">axInvPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">]</span>
        <span class="n">axcPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]</span>
        <span class="n">tempylab</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;Nb. iterations&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\chi^2_N$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Reg. param. (a.u.)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Obj. func. (a.u.)&quot;</span><span class="p">]</span>
        <span class="n">tempPos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">]]</span>
        <span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="n">Nit</span><span class="p">,</span><span class="n">Chi2N</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">R</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">temps</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">temps</span><span class="p">[</span><span class="n">ii</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">tempPos</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">tempylab</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="n">axTMat</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">fW</span><span class="p">,</span><span class="n">fH</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span><span class="mi">12</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">axInvPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">]</span>
        <span class="n">axcPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]</span>
        <span class="n">tempylab</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Nb. iterations&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\mathbf{\chi^2_N}$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Reg. param. (a.u.)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Obj. func. (a.u.)&quot;</span><span class="p">]</span>
        <span class="n">tempPos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">]]</span>
        <span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="n">SXR</span><span class="p">,</span><span class="n">Nit</span><span class="p">,</span><span class="n">Chi2N</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">R</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">temps</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">temps</span><span class="p">[</span><span class="n">ii</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">tempPos</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">tempylab</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">TMat</span><span class="p">:</span>
            <span class="n">TMatPos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">]</span>
            <span class="n">TMatylab</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axTMat</span> <span class="o">=</span> <span class="kc">None</span>


    <span class="k">if</span> <span class="n">TMat</span><span class="p">:</span>
        <span class="n">axTMat</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">TMatPos</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">axTMat</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">TMatylab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">Laxtemp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tempPos</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ypos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">tempPos</span><span class="p">])</span>
        <span class="n">indmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">ypos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tempPos</span><span class="p">)):</span>
            <span class="n">Laxtemp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">tempPos</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
            <span class="n">Laxtemp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tempylab</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ii</span> <span class="o">==</span> <span class="n">indmin</span><span class="p">:</span>
                <span class="n">Laxtemp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="n">Laxtemp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">ypos</span><span class="p">)]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">axInv</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axInvPos</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">axc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axcPos</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">axInv</span><span class="p">,</span> <span class="n">axTMat</span><span class="p">,</span> <span class="n">Laxtemp</span><span class="p">,</span> <span class="n">axc</span></div>



<span class="k">def</span> <span class="nf">Plot_Inv_FFTPow_DefAxes</span><span class="p">(</span><span class="n">NPts</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">axInv</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axRetro</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSXR</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">axRetro</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Channels&quot;</span><span class="p">),</span> <span class="n">axRetro</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span><span class="p">)</span>
    <span class="n">axSXR</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span><span class="p">)</span>

    <span class="n">Lax</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">NPts</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Hei</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">0.58</span><span class="o">-</span><span class="mf">0.05</span><span class="p">)</span><span class="o">/</span><span class="n">NPts</span> <span class="o">-</span> <span class="p">(</span><span class="n">NPts</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dis</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NPts</span><span class="p">):</span>
            <span class="n">Lax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.58</span><span class="o">-</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hei</span><span class="o">-</span><span class="n">ii</span><span class="o">*</span><span class="n">Dis</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="n">Hei</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">N2</span><span class="p">,</span> <span class="n">Dis</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">NPts</span><span class="o">/</span><span class="mf">2.</span><span class="p">)),</span> <span class="mf">0.03</span>
        <span class="n">Hei</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.58</span><span class="o">-</span><span class="mf">0.05</span><span class="o">-</span><span class="p">(</span><span class="n">N2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dis</span><span class="p">)</span><span class="o">/</span><span class="n">N2</span>
        <span class="n">LaxPos</span> <span class="o">=</span> <span class="p">[[[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.58</span><span class="o">-</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hei</span><span class="o">-</span><span class="n">ii</span><span class="o">*</span><span class="n">Dis</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="n">Hei</span><span class="p">],[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.58</span><span class="o">-</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hei</span><span class="o">-</span><span class="n">ii</span><span class="o">*</span><span class="n">Dis</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="n">Hei</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N2</span><span class="p">)]</span>
        <span class="c1">#LaxPos = list(itt.chain._from_iterable(LaxPos))</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N2</span><span class="p">):</span>
            <span class="n">Lax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">LaxPos</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Lax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">LaxPos</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axInv</span><span class="p">,</span> <span class="n">axc</span><span class="p">,</span> <span class="n">axRetro</span><span class="p">,</span> <span class="n">axSXR</span><span class="p">,</span> <span class="n">Lax</span>



<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">                Defaults settings of ToFu_PostTreat</span>
<span class="sd">###############################################################################</span>
<span class="sd">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>



<span class="c1"># --- Plotting dictionaries and parameters ------</span>

<span class="n">InvPlotSubP</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">InvPlotSubMode</span> <span class="o">=</span> <span class="s1">&#39;abs&#39;</span>
<span class="n">InvPlotF</span> <span class="o">=</span> <span class="s1">&#39;contour&#39;</span> <span class="c1">#&#39;imshow&#39;</span>
<span class="n">InvLvls</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">Invdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span>
<span class="n">Tempd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">}</span>
<span class="n">Retrod</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">}</span>
<span class="n">vlined</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">}</span>
<span class="n">InvSXRd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">}</span>
<span class="n">InvSigmad</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">),</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">}</span>
<span class="n">InvPlot_LPath</span> <span class="o">=</span> <span class="p">[((</span><span class="mf">1.70</span><span class="p">,</span><span class="mf">0.</span><span class="p">),(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)),</span> <span class="p">((</span><span class="mf">1.70</span><span class="p">,</span><span class="mf">0.</span><span class="p">),(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)),</span> <span class="p">((</span><span class="mf">1.70</span><span class="p">,</span><span class="mf">0.20</span><span class="p">),(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)),</span> <span class="p">((</span><span class="mf">1.70</span><span class="p">,</span><span class="o">-</span><span class="mf">0.20</span><span class="p">),(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)),</span> <span class="p">((</span><span class="mf">1.55</span><span class="p">,</span><span class="mf">0.</span><span class="p">),(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)),</span> <span class="p">((</span><span class="mf">1.85</span><span class="p">,</span><span class="mf">0.</span><span class="p">),(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">))]</span>
<span class="n">InvPlot_dl</span> <span class="o">=</span> <span class="mf">0.0025</span>
<span class="n">InvPlot_LCol</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>

<span class="n">TFPT_prop</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Deriv&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;indt0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;t0&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;DVect&#39;</span><span class="p">:</span><span class="n">BF2_DVect_DefR</span><span class="p">,</span> <span class="s1">&#39;SubP&#39;</span><span class="p">:</span><span class="n">InvPlotSubP</span><span class="p">,</span> <span class="s1">&#39;SubMode&#39;</span><span class="p">:</span><span class="n">InvPlotSubMode</span><span class="p">,</span> <span class="s1">&#39;InvPlotFunc&#39;</span><span class="p">:</span><span class="n">InvPlotF</span><span class="p">,</span> <span class="s1">&#39;InvLvls&#39;</span><span class="p">:</span><span class="n">InvLvls</span><span class="p">,</span> <span class="s1">&#39;Invd&#39;</span><span class="p">:</span><span class="n">Invdict</span><span class="p">,</span>
        <span class="s1">&#39;vlined&#39;</span><span class="p">:</span><span class="n">vlined</span><span class="p">,</span> <span class="s1">&#39;SXRd&#39;</span><span class="p">:</span><span class="n">InvSXRd</span><span class="p">,</span> <span class="s1">&#39;Sigmad&#39;</span><span class="p">:</span><span class="n">InvSigmad</span><span class="p">,</span> <span class="s1">&#39;Tempd&#39;</span><span class="p">:</span><span class="n">Tempd</span><span class="p">,</span> <span class="s1">&#39;Retrod&#39;</span><span class="p">:</span><span class="n">Retrod</span><span class="p">,</span> <span class="s1">&#39;VMinMax&#39;</span><span class="p">:[</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">],</span> <span class="s1">&#39;Com&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Norm&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;a4&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>

<span class="n">TFPT_propbasic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">TFPT_proptechnical</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">TFPT_propprofiles</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LPath&#39;</span><span class="p">:</span><span class="n">InvPlot_LPath</span><span class="p">,</span> <span class="s1">&#39;dl&#39;</span><span class="p">:</span><span class="n">InvPlot_dl</span><span class="p">}</span>

<span class="n">TFPT_propbasic</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">TFPT_prop</span><span class="p">)</span>
<span class="n">TFPT_proptechnical</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">TFPT_prop</span><span class="p">)</span>
<span class="n">TFPT_propprofiles</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">TFPT_prop</span><span class="p">)</span>



<span class="n">TFPT_Lprop</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;basic&#39;</span><span class="p">:</span><span class="n">TFPT_propbasic</span><span class="p">,</span> <span class="s1">&#39;technical&#39;</span><span class="p">:</span><span class="n">TFPT_proptechnical</span><span class="p">,</span> <span class="s1">&#39;profiles&#39;</span><span class="p">:</span><span class="n">TFPT_propprofiles</span><span class="p">,</span> <span class="s1">&#39;sawtooth&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span>


<span class="n">InvAnimIntervalms</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">InvAnimBlit</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">InvAnimRepeat</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">InvAnimRepeatDelay</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">InvAnimTimeScale</span> <span class="o">=</span> <span class="mf">1.e2</span>





<span class="c1"># -------------- Figures ------------------------</span>


<div class="viewcode-block" id="Plot_Inv_Basic_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_Basic_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_Basic_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="n">axInv</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axTMat</span>  <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSig</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axTxt</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="n">axInv</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTMat</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTxt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span> <span class="n">axTxt</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">axTxt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">axTxt</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\epsilon$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

    <span class="n">axInv</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axInv</span><span class="p">,</span> <span class="n">axTMat</span><span class="p">,</span> <span class="n">axSig</span><span class="p">,</span> <span class="n">axc</span><span class="p">,</span> <span class="n">axTxt</span></div>


<div class="viewcode-block" id="Plot_Inv_Technical_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_Technical_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_Technical_DefAxes</span><span class="p">(</span><span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="n">axInv</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axTMat</span>  <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSig</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axNit</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axChi2N</span> <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axMu</span>    <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axR</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axTxt</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="n">axInv</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">),</span>                 <span class="n">axInv</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTMat</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">),</span>          <span class="n">axSig</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axNit</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Nb. iterations&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axChi2N</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathbf{\chi^2_N}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axMu</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Reg. param. (a.u.)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axR</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">),</span>                   <span class="n">axR</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Obj. func. (a.u.)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTxt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span> <span class="n">axTxt</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([]),</span>                                 <span class="n">axTxt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">axTxt</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\epsilon$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

    <span class="n">axInv</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axInv</span><span class="p">,</span> <span class="n">axTMat</span><span class="p">,</span> <span class="p">[</span><span class="n">axSig</span><span class="p">,</span><span class="n">axNit</span><span class="p">,</span><span class="n">axChi2N</span><span class="p">,</span><span class="n">axMu</span><span class="p">,</span><span class="n">axR</span><span class="p">],</span> <span class="n">axc</span><span class="p">,</span> <span class="n">axTxt</span></div>


<div class="viewcode-block" id="Plot_Inv_Profiles_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_Profiles_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_Profiles_DefAxes</span><span class="p">(</span><span class="n">NL</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="n">axInv</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axTMat</span>  <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSig</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">),</span>                 <span class="n">axInv</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTMat</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">),</span>          <span class="n">axSig</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">LaxP</span><span class="p">,</span> <span class="n">RefUp</span><span class="p">,</span> <span class="n">RefDo</span><span class="p">,</span> <span class="n">Dz</span> <span class="o">=</span> <span class="p">[],</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span>
    <span class="n">nl</span> <span class="o">=</span> <span class="p">(</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">RefUp</span><span class="o">-</span><span class="n">RefDo</span> <span class="o">-</span> <span class="p">(</span><span class="n">nl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dz</span><span class="p">)</span><span class="o">/</span><span class="n">nl</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NL</span><span class="p">):</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">ii</span><span class="o">/</span><span class="n">nl</span>
        <span class="n">il</span> <span class="o">=</span> <span class="n">ii</span><span class="o">-</span><span class="n">cc</span><span class="o">*</span><span class="n">nl</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span> <span class="o">+</span> <span class="n">cc</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">RefUp</span><span class="o">-</span><span class="p">(</span><span class="n">il</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="o">-</span><span class="n">il</span><span class="o">*</span><span class="n">Dz</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="n">H</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">LaxP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">il</span> <span class="o">==</span> <span class="n">nl</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">LaxP</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Length (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cc</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">LaxP</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathbf{\epsilon^{\eta}}$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTxt</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">axTxt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span> <span class="n">axTxt</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([]),</span>                                 <span class="n">axTxt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">axTxt</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\epsilon$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

    <span class="n">axInv</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axInv</span><span class="p">,</span> <span class="n">axTMat</span><span class="p">,</span> <span class="n">axSig</span><span class="p">,</span> <span class="n">LaxP</span><span class="p">,</span> <span class="n">axc</span><span class="p">,</span> <span class="n">axTxt</span></div>


<div class="viewcode-block" id="Plot_Inv_Compare_Basic_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_Compare_Basic_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_Compare_Basic_DefAxes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>

    <span class="n">MR</span><span class="p">,</span> <span class="n">ML</span><span class="p">,</span> <span class="n">DX</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.04</span>
    <span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">MR</span><span class="o">+</span><span class="n">ML</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">DX</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>

    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="n">axTMat</span>  <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSig</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.</span><span class="o">-</span><span class="n">MR</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>

    <span class="n">LaxInv</span><span class="p">,</span> <span class="n">LaxTxt</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="n">LaxInv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ML</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="p">(</span><span class="n">DX</span><span class="o">+</span><span class="n">W</span><span class="p">),</span> <span class="mf">0.46</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
        <span class="n">LaxTxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ML</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="p">(</span><span class="n">DX</span><span class="o">+</span><span class="n">W</span><span class="p">),</span> <span class="mf">0.90</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">))</span>
        <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ii</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span>      <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1">#axTMat.set_ylabel(r&quot;Signal (mW)&quot;, fontsize=12, fontweight=&#39;bold&#39;)</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\epsilon$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTMat</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Chan.&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">LaxInv</span><span class="p">,</span> <span class="n">axTMat</span><span class="p">,</span> <span class="n">axSig</span><span class="p">,</span> <span class="n">axc</span><span class="p">,</span> <span class="n">LaxTxt</span></div>


<div class="viewcode-block" id="Plot_Inv_Compare_Technical_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_Compare_Technical_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_Compare_Technical_DefAxes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>

    <span class="n">MR</span><span class="p">,</span> <span class="n">ML</span><span class="p">,</span> <span class="n">DX</span> <span class="o">=</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04</span>
    <span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">MR</span><span class="o">+</span><span class="n">ML</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">DX</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>

    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="n">axTMat</span>  <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSig</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axNit</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axChi2N</span> <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axMu</span>    <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axR</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.</span><span class="o">-</span><span class="n">MR</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>

    <span class="n">LaxInv</span><span class="p">,</span> <span class="n">LaxTxt</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="n">LaxInv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ML</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="p">(</span><span class="n">DX</span><span class="o">+</span><span class="n">W</span><span class="p">),</span> <span class="mf">0.48</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
        <span class="n">LaxTxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ML</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="p">(</span><span class="n">DX</span><span class="o">+</span><span class="n">W</span><span class="p">),</span> <span class="mf">0.90</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">))</span>
        <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ii</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span>      <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1">#axTMat.set_ylabel(r&quot;Signal (mW)&quot;, fontsize=12, fontweight=&#39;bold&#39;)</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\epsilon$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTMat</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Chan.&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axNit</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">),</span>  <span class="n">axNit</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$N_</span><span class="si">{it}</span><span class="s2">$&quot;</span><span class="p">)</span>
    <span class="n">axChi2N</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\chi^2_N$&quot;</span><span class="p">)</span>
    <span class="n">axMu</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">),</span>  <span class="n">axMu</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Reg. param. (a.u.)&quot;</span><span class="p">)</span>
    <span class="n">axR</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Obj. func. (a.u.)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">LaxInv</span><span class="p">,</span> <span class="n">axTMat</span><span class="p">,</span> <span class="p">[</span><span class="n">axSig</span><span class="p">,</span><span class="n">axNit</span><span class="p">,</span><span class="n">axChi2N</span><span class="p">,</span><span class="n">axMu</span><span class="p">,</span><span class="n">axR</span><span class="p">],</span> <span class="n">axc</span><span class="p">,</span> <span class="n">LaxTxt</span></div>


<div class="viewcode-block" id="Plot_Inv_Compare_Profiles_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_Compare_Profiles_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_Compare_Profiles_DefAxes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NL</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>

    <span class="n">MR</span><span class="p">,</span> <span class="n">ML</span><span class="p">,</span> <span class="n">DX</span> <span class="o">=</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04</span>
    <span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">MR</span><span class="o">+</span><span class="n">ML</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">DX</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>

    <span class="n">axCol</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="n">axTMat</span>  <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSig</span>   <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span>     <span class="o">=</span>   <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.</span><span class="o">-</span><span class="n">MR</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>

    <span class="n">LaxInv</span><span class="p">,</span> <span class="n">LaxTxt</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="n">LaxInv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ML</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="p">(</span><span class="n">DX</span><span class="o">+</span><span class="n">W</span><span class="p">),</span> <span class="mf">0.54</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
        <span class="n">LaxTxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ML</span><span class="o">+</span><span class="n">ii</span><span class="o">*</span><span class="p">(</span><span class="n">DX</span><span class="o">+</span><span class="n">W</span><span class="p">),</span> <span class="mf">0.92</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">))</span>
        <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ii</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([]),</span>      <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">LaxTxt</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="n">LaxInv</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">LaxP</span><span class="p">,</span> <span class="n">LaxPbis</span><span class="p">,</span> <span class="n">RefUp</span><span class="p">,</span> <span class="n">RefDo</span><span class="p">,</span> <span class="n">Dz</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04</span>
    <span class="n">nl</span> <span class="o">=</span> <span class="p">(</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">RefUp</span><span class="o">-</span><span class="n">RefDo</span> <span class="o">-</span> <span class="p">(</span><span class="n">nl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dz</span><span class="p">)</span><span class="o">/</span><span class="n">nl</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NL</span><span class="p">):</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">ii</span><span class="o">/</span><span class="n">nl</span>
        <span class="n">il</span> <span class="o">=</span> <span class="n">ii</span><span class="o">-</span><span class="n">cc</span><span class="o">*</span><span class="n">nl</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span> <span class="o">+</span> <span class="n">cc</span><span class="o">*</span><span class="mf">0.32</span><span class="p">,</span> <span class="n">RefUp</span><span class="o">-</span><span class="p">(</span><span class="n">il</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="o">-</span><span class="n">il</span><span class="o">*</span><span class="n">Dz</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="n">H</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
        <span class="n">LaxP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="c1">#LaxPbis.append(ax.twiny())</span>
        <span class="k">if</span> <span class="n">il</span> <span class="o">==</span> <span class="n">nl</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">LaxP</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Length (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cc</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">LaxP</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathbf{\epsilon^{\eta}}$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1">#axTMat.set_ylabel(r&quot;Signal (mW)&quot;, fontsize=12, fontweight=&#39;bold&#39;)</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\epsilon$ (W/m^3)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Signal (mW)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axSig</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axTMat</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Chan.&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">LaxInv</span><span class="p">,</span> <span class="n">axTMat</span><span class="p">,</span> <span class="n">axSig</span><span class="p">,</span> <span class="n">LaxP</span><span class="p">,</span> <span class="n">LaxPbis</span><span class="p">,</span> <span class="n">axc</span><span class="p">,</span> <span class="n">LaxTxt</span></div>


















<div class="viewcode-block" id="Plot_Inv_FFTPow_DefAxes"><a class="viewcode-back" href="../../tofu.html#tofu.defaults.Plot_Inv_FFTPow_DefAxes">[docs]</a><span class="k">def</span> <span class="nf">Plot_Inv_FFTPow_DefAxes</span><span class="p">(</span><span class="n">NPts</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">a4</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">,</span><span class="n">fdpi</span><span class="p">,</span><span class="n">axCol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span><span class="mf">8.27</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a4</span> <span class="k">else</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fW</span><span class="p">,</span><span class="n">fH</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="n">axCol</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="n">fdpi</span><span class="p">)</span>
    <span class="n">axInv</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axRetro</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axSXR</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axInv</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">axRetro</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Channels&quot;</span><span class="p">),</span> <span class="n">axRetro</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span><span class="p">)</span>
    <span class="n">axSXR</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SXR (mW)&quot;</span><span class="p">)</span>

    <span class="n">Lax</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">NPts</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Hei</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">0.58</span><span class="o">-</span><span class="mf">0.05</span><span class="p">)</span><span class="o">/</span><span class="n">NPts</span> <span class="o">-</span> <span class="p">(</span><span class="n">NPts</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dis</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NPts</span><span class="p">):</span>
            <span class="n">Lax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.58</span><span class="o">-</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hei</span><span class="o">-</span><span class="n">ii</span><span class="o">*</span><span class="n">Dis</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="n">Hei</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">N2</span><span class="p">,</span> <span class="n">Dis</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">NPts</span><span class="o">/</span><span class="mf">2.</span><span class="p">)),</span> <span class="mf">0.03</span>
        <span class="n">Hei</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.58</span><span class="o">-</span><span class="mf">0.05</span><span class="o">-</span><span class="p">(</span><span class="n">N2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Dis</span><span class="p">)</span><span class="o">/</span><span class="n">N2</span>
        <span class="n">LaxPos</span> <span class="o">=</span> <span class="p">[[[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.58</span><span class="o">-</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hei</span><span class="o">-</span><span class="n">ii</span><span class="o">*</span><span class="n">Dis</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="n">Hei</span><span class="p">],[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.58</span><span class="o">-</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hei</span><span class="o">-</span><span class="n">ii</span><span class="o">*</span><span class="n">Dis</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="n">Hei</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N2</span><span class="p">)]</span>
        <span class="c1">#LaxPos = list(itt.chain._from_iterable(LaxPos))</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N2</span><span class="p">):</span>
            <span class="n">Lax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">LaxPos</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Freq. (kHz)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Lax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">LaxPos</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="n">axCol</span><span class="p">))</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]),</span> <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">Lax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axInv</span><span class="p">,</span> <span class="n">axc</span><span class="p">,</span> <span class="n">axRetro</span><span class="p">,</span> <span class="n">axSXR</span><span class="p">,</span> <span class="n">Lax</span></div>




</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2016-2021, Tofu contributors.<br/>
      Last updated on Nov 15, 2021.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>