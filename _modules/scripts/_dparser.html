<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>scripts._dparser &#8212; Tofu 1.5.0</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          tofu</a>
        <span class="navbar-text navbar-version pull-left"><b>1.5.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../installation.html">Installation</a></li>
                <li><a href="../../contributing.html">Contributing</a></li>
                <li><a href="../../auto_examples/index.html">Gallery</a></li>
                <li><a href="../../aboutus.html">About</a></li>
                <li><a href="../../releases.html">Releases</a></li>
                <li><a href="../../tofu.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">How to install tofu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">A guide to contributing to tofu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/tutorials/tuto_plot_gallery_fusion_machines.html">A list of all different device configurations available (ITER, WEST, JET, ...)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Tutorials and examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu_from_bash.html">Using tofu from a bash terminal</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.html">tofu package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.geom.html">tofu.geom package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.dumpro.html">tofu.dumpro package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.data.html">tofu.data package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tofu.dust.html">tofu.dust package</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for scripts._dparser</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">argparse</span>


<span class="c1"># tofu</span>
<span class="c1"># test if in a tofu git repo</span>
<span class="n">_HERE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">_TOFUPATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">_HERE</span><span class="p">)</span>


<div class="viewcode-block" id="get_mods"><a class="viewcode-back" href="../../scripts.html#scripts._dparser.get_mods">[docs]</a><span class="k">def</span> <span class="nf">get_mods</span><span class="p">():</span>
    <span class="n">istofugit</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s1">&#39;.git&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">_TOFUPATH</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;tofu&#39;</span> <span class="ow">in</span> <span class="n">_TOFUPATH</span><span class="p">:</span>
        <span class="n">istofugit</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">istofugit</span><span class="p">:</span>
        <span class="c1"># Make sure we load the corresponding tofu</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">_TOFUPATH</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">tofu</span> <span class="k">as</span> <span class="nn">tf</span>
        <span class="kn">from</span> <span class="nn">tofu.imas2tofu</span> <span class="kn">import</span> <span class="n">MultiIDSLoader</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">tofu</span> <span class="k">as</span> <span class="nn">tf</span>
        <span class="kn">from</span> <span class="nn">tofu.imas2tofu</span> <span class="kn">import</span> <span class="n">MultiIDSLoader</span>

    <span class="c1"># default parameters</span>
    <span class="n">pfe</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;.tofu&#39;</span><span class="p">,</span> <span class="s1">&#39;_scripts_def.py&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">pfe</span><span class="p">):</span>
        <span class="c1"># Make sure we load the user-specific file</span>
        <span class="c1"># sys.path method</span>
        <span class="c1"># sys.path.insert(1, os.path.join(os.path.expanduser(&#39;~&#39;), &#39;.tofu&#39;))</span>
        <span class="c1"># import _scripts_def as _defscripts</span>
        <span class="c1"># _ = sys.path.pop(1)</span>
        <span class="c1"># importlib method</span>
        <span class="kn">import</span> <span class="nn">importlib.util</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="s2">&quot;_defscripts&quot;</span><span class="p">,</span> <span class="n">pfe</span><span class="p">)</span>
        <span class="n">_defscripts</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">_defscripts</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">tofu.entrypoints._def</span> <span class="k">as</span> <span class="nn">_defscripts</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_def</span> <span class="k">as</span> <span class="n">_defscripts</span>
    <span class="k">return</span> <span class="n">tf</span><span class="p">,</span> <span class="n">MultiIDSLoader</span><span class="p">,</span> <span class="n">_defscripts</span></div>


<span class="c1"># #############################################################################</span>
<span class="c1">#       utility functions</span>
<span class="c1"># #############################################################################</span>


<div class="viewcode-block" id="_str2bool"><a class="viewcode-back" href="../../scripts.html#scripts._dparser._str2bool">[docs]</a><span class="k">def</span> <span class="nf">_str2bool</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">v</span>
    <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentTypeError</span><span class="p">(</span><span class="s1">&#39;Boolean value expected!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="_str2boolstr"><a class="viewcode-back" href="../../scripts.html#scripts._dparser._str2boolstr">[docs]</a><span class="k">def</span> <span class="nf">_str2boolstr</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">v</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentTypeError</span><span class="p">(</span><span class="s1">&#39;Boolean, None or str expected!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="_str2tlim"><a class="viewcode-back" href="../../scripts.html#scripts._dparser._str2tlim">[docs]</a><span class="k">def</span> <span class="nf">_str2tlim</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
          <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">v</span>
              <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span>
              <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">vv</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)])))</span>
    <span class="k">if</span> <span class="n">c0</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">v</span></div>


<span class="c1"># #############################################################################</span>
<span class="c1">#       Parser for tofu version</span>
<span class="c1"># #############################################################################</span>


<div class="viewcode-block" id="parser_version"><a class="viewcode-back" href="../../scripts.html#scripts._dparser.parser_version">[docs]</a><span class="k">def</span> <span class="nf">parser_version</span><span class="p">():</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot; Get tofu version from bash optionally set an enviroment variable</span>

<span class="s2">    If run from a git repo containing tofu, simply returns git describe</span>
<span class="s2">    Otherwise reads the tofu version stored in tofu/version.py</span>

<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">ddef</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_TOFUPATH</span><span class="p">,</span> <span class="s1">&#39;tofu&#39;</span><span class="p">),</span>
        <span class="s1">&#39;envvar&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;verb&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;warn&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;force&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TOFU_VERSION&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Instanciate parser</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Define input arguments</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--path&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;tofu source directory where version.py is found&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-v&#39;</span><span class="p">,</span> <span class="s1">&#39;--verb&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;flag indicating whether to print the version&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;verb&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ev&#39;</span><span class="p">,</span> <span class="s1">&#39;--envvar&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="n">_str2boolstr</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;name of the environment variable to set, if any&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;envvar&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-w&#39;</span><span class="p">,</span> <span class="s1">&#39;--warn&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;flag indicatin whether to print a warning when&#39;</span>
                              <span class="o">+</span> <span class="s1">&#39;the desired environment variable (envvar)&#39;</span>
                              <span class="o">+</span> <span class="s1">&#39;already exists&#39;</span><span class="p">),</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;warn&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--force&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;flag indicating whether to force the update of &#39;</span>
                              <span class="o">+</span> <span class="s1">&#39;the desired environment variable (envvar)&#39;</span>
                              <span class="o">+</span> <span class="s1">&#39; even if it already exists&#39;</span><span class="p">),</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ddef</span><span class="p">,</span> <span class="n">parser</span></div>


<span class="c1"># #############################################################################</span>
<span class="c1">#       Parser for tofu custom</span>
<span class="c1"># #############################################################################</span>


<div class="viewcode-block" id="parser_custom"><a class="viewcode-back" href="../../scripts.html#scripts._dparser.parser_custom">[docs]</a><span class="k">def</span> <span class="nf">parser_custom</span><span class="p">():</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot; Create a local copy of tofu default parameters</span>

<span class="s2">    This creates a local copy, in your home, of tofu default parameters</span>
<span class="s2">    A directory .tofu is created in your home directory</span>
<span class="s2">    In this directory, modules containing default parameters are copied</span>
<span class="s2">    You can then customize them without impacting other users</span>

<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">_USER</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span>
    <span class="n">_USER_HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>

    <span class="n">ddef</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_USER_HOME</span><span class="p">,</span> <span class="s1">&#39;.tofu&#39;</span><span class="p">),</span>
        <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_TOFUPATH</span><span class="p">,</span> <span class="s1">&#39;tofu&#39;</span><span class="p">),</span>
        <span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;_imas2tofu_def.py&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_entrypoints_def.py&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;directories&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;openadas2tofu&#39;</span><span class="p">,</span>
            <span class="s1">&#39;nist2tofu&#39;</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;nist2tofu&#39;</span><span class="p">,</span> <span class="s1">&#39;ASD&#39;</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>

    <span class="c1"># Instanciate parser</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Define input arguments</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s1">&#39;--source&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;tofu source directory&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--target&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;directory where .tofu/ should be created&#39;</span>
                              <span class="o">+</span> <span class="s1">&#39; (default: </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])),</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--files&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;list of files to be copied&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">],</span>
                        <span class="n">choices</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ddef</span><span class="p">,</span> <span class="n">parser</span></div>


<span class="c1"># #############################################################################</span>
<span class="c1">#       Parser for tofu plot</span>
<span class="c1"># #############################################################################</span>


<div class="viewcode-block" id="parser_plot"><a class="viewcode-back" href="../../scripts.html#scripts._dparser.parser_plot">[docs]</a><span class="k">def</span> <span class="nf">parser_plot</span><span class="p">():</span>

    <span class="n">tf</span><span class="p">,</span> <span class="n">MultiIDSLoader</span><span class="p">,</span> <span class="n">_defscripts</span> <span class="o">=</span> <span class="n">get_mods</span><span class="p">()</span>

    <span class="n">_LIDS_CONFIG</span> <span class="o">=</span> <span class="n">MultiIDSLoader</span><span class="o">.</span><span class="n">_lidsconfig</span>
    <span class="n">_LIDS_DIAG</span> <span class="o">=</span> <span class="n">MultiIDSLoader</span><span class="o">.</span><span class="n">_lidsdiag</span>
    <span class="n">_LIDS_PLASMA</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">imas2tofu</span><span class="o">.</span><span class="n">MultiIDSLoader</span><span class="o">.</span><span class="n">_lidsplasma</span>
    <span class="n">_LIDS</span> <span class="o">=</span> <span class="n">_LIDS_CONFIG</span> <span class="o">+</span> <span class="n">_LIDS_DIAG</span> <span class="o">+</span> <span class="n">_LIDS_PLASMA</span> <span class="o">+</span> <span class="n">tf</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">_LIDS_CUSTOM</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Fast interactive visualization tool for diagnostics data in</span>
<span class="s2">    imas</span>

<span class="s2">    This is merely a wrapper around the function tofu.load_from_imas()</span>
<span class="s2">    It loads (from imas) and displays diagnostics data from the following</span>
<span class="s2">    ids:</span>
<span class="s2">        </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_LIDS</span><span class="p">)</span>

    <span class="n">ddef</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># User-customizable</span>
        <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_RUN</span><span class="p">,</span>
        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_USER</span><span class="p">,</span>
        <span class="s1">&#39;database&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_DATABASE</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_VERSION</span><span class="p">,</span>
        <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_T0</span><span class="p">,</span>
        <span class="s1">&#39;tlim&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;sharex&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_SHAREX</span><span class="p">,</span>
        <span class="s1">&#39;bck&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_BCK</span><span class="p">,</span>
        <span class="s1">&#39;extra&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_EXTRA</span><span class="p">,</span>
        <span class="s1">&#39;indch_auto&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_INDCH_AUTO</span><span class="p">,</span>

        <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_CONFIG</span><span class="p">,</span>
        <span class="s1">&#39;tosoledge3x&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_TOSOLEDGE3X</span><span class="p">,</span>

        <span class="s1">&#39;mag_sep_nbpts&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_MAG_SEP_NBPTS</span><span class="p">,</span>
        <span class="s1">&#39;mag_sep_dR&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_MAG_SEP_DR</span><span class="p">,</span>
        <span class="s1">&#39;mag_init_pts&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFPLOT_MAG_INIT_PTS</span><span class="p">,</span>

        <span class="c1"># Non user-customizable</span>
        <span class="s1">&#39;lids_plasma&#39;</span><span class="p">:</span> <span class="n">_LIDS_PLASMA</span><span class="p">,</span>
        <span class="s1">&#39;lids_diag&#39;</span><span class="p">:</span> <span class="n">_LIDS_DIAG</span><span class="p">,</span>
        <span class="s1">&#39;lids&#39;</span><span class="p">:</span> <span class="n">_LIDS</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;config name to be loaded&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;--config&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">])</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;path in which to save the tofu config in SOLEDGE3X format&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-tse3x&#39;</span><span class="p">,</span> <span class="s1">&#39;--tosoledge3x&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;tosoledge3x&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s1">&#39;--shot&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;shot number&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;username of the DB where the datafile is located&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-u&#39;</span><span class="p">,</span> <span class="s1">&#39;--user&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;database name where the datafile is located&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-db&#39;</span><span class="p">,</span> <span class="s1">&#39;--database&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;database&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;--run&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;run number&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;run&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-v&#39;</span><span class="p">,</span> <span class="s1">&#39;--version&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;version number&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">])</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;ids from which to load diagnostics data,&quot;</span>
           <span class="o">+</span> <span class="s2">&quot; can be:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;lids&#39;</span><span class="p">]))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--ids&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;lids&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-q&#39;</span><span class="p">,</span> <span class="s1">&#39;--quantity&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Desired quantity from the plasma ids&#39;</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-X&#39;</span><span class="p">,</span> <span class="s1">&#39;--X&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Quantity from the plasma ids for abscissa&#39;</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t0&#39;</span><span class="p">,</span> <span class="s1">&#39;--t0&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2boolstr</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Reference time event setting t = 0&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--t&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Input time when needed&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-tl&#39;</span><span class="p">,</span> <span class="s1">&#39;--tlim&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2tlim</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;limits of the time interval&#39;</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;tlim&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ich&#39;</span><span class="p">,</span> <span class="s1">&#39;--indch&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;indices of channels to be loaded&#39;</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ichauto&#39;</span><span class="p">,</span> <span class="s1">&#39;--indch_auto&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;automatically determine indices of&#39;</span>
                        <span class="o">+</span> <span class="s1">&#39; channels to be loaded&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;indch_auto&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-e&#39;</span><span class="p">,</span> <span class="s1">&#39;--extra&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;If True loads separatrix and heating power&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-sx&#39;</span><span class="p">,</span> <span class="s1">&#39;--sharex&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Should X axis be shared between diag ids ?&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;sharex&#39;</span><span class="p">],</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-bck&#39;</span><span class="p">,</span> <span class="s1">&#39;--background&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Plot data enveloppe as grey background ?&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;bck&#39;</span><span class="p">],</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-mag_sep_dR&#39;</span><span class="p">,</span> <span class="s1">&#39;--mag_sep_dR&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;mag_sep_dR&#39;</span><span class="p">],</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Distance to separatrix from r_ext to plot&#39;</span>
                        <span class="o">+</span> <span class="s1">&#39; magnetic field lines&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-mag_sep_nbpts&#39;</span><span class="p">,</span> <span class="s1">&#39;--mag_sep_nbpts&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;mag_sep_nbpts&#39;</span><span class="p">],</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Number of mag. field lines to plot &#39;</span>
                              <span class="o">+</span> <span class="s1">&#39;from separatrix&#39;</span><span class="p">))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-mag_init_pts&#39;</span><span class="p">,</span> <span class="s1">&#39;--mag_init_pts&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;mag_init_pts&#39;</span><span class="p">],</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Manual coordinates of point that a RED magnetic&#39;</span>
                        <span class="o">+</span> <span class="s1">&#39; field line will cross on graphics,&#39;</span>
                        <span class="o">+</span> <span class="s1">&#39; give coordinates as: R [m], Phi [rad], Z [m]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ddef</span><span class="p">,</span> <span class="n">parser</span></div>


<span class="c1"># #############################################################################</span>
<span class="c1">#       Parser for tofu calc</span>
<span class="c1"># #############################################################################</span>


<div class="viewcode-block" id="parser_calc"><a class="viewcode-back" href="../../scripts.html#scripts._dparser.parser_calc">[docs]</a><span class="k">def</span> <span class="nf">parser_calc</span><span class="p">():</span>

    <span class="n">tf</span><span class="p">,</span> <span class="n">MultiIDSLoader</span><span class="p">,</span> <span class="n">_defscripts</span> <span class="o">=</span> <span class="n">get_mods</span><span class="p">()</span>

    <span class="n">_LIDS_DIAG</span> <span class="o">=</span> <span class="n">MultiIDSLoader</span><span class="o">.</span><span class="n">_lidsdiag</span>
    <span class="n">_LIDS_PLASMA</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">imas2tofu</span><span class="o">.</span><span class="n">MultiIDSLoader</span><span class="o">.</span><span class="n">_lidsplasma</span>
    <span class="n">_LIDS</span> <span class="o">=</span> <span class="n">_LIDS_DIAG</span> <span class="o">+</span> <span class="n">_LIDS_PLASMA</span> <span class="o">+</span> <span class="n">tf</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">_LIDS_CUSTOM</span>

    <span class="c1"># Parse input arguments</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Fast interactive visualization tool for diagnostics data in</span>
<span class="s2">    imas</span>

<span class="s2">    This is merely a wrapper around the function tofu.calc_from_imas()</span>
<span class="s2">    It calculates and dsplays synthetic signal (from imas) from the following</span>
<span class="s2">    ids:</span>
<span class="s2">        </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_LIDS</span><span class="p">)</span>

    <span class="n">ddef</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># User-customizable</span>
        <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_RUN</span><span class="p">,</span>
        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_USER</span><span class="p">,</span>
        <span class="s1">&#39;database&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_DATABASE</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_VERSION</span><span class="p">,</span>
        <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_T0</span><span class="p">,</span>
        <span class="s1">&#39;tlim&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;sharex&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_SHAREX</span><span class="p">,</span>
        <span class="s1">&#39;bck&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_BCK</span><span class="p">,</span>
        <span class="s1">&#39;extra&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_EXTRA</span><span class="p">,</span>
        <span class="s1">&#39;indch_auto&#39;</span><span class="p">:</span> <span class="n">_defscripts</span><span class="o">.</span><span class="n">_TFCALC_INDCH_AUTO</span><span class="p">,</span>
        <span class="s1">&#39;coefs&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>

        <span class="c1"># Non user-customizable</span>
        <span class="s1">&#39;lids_plasma&#39;</span><span class="p">:</span> <span class="n">_LIDS_PLASMA</span><span class="p">,</span>
        <span class="s1">&#39;lids_diag&#39;</span><span class="p">:</span> <span class="n">_LIDS_DIAG</span><span class="p">,</span>
        <span class="s1">&#39;lids&#39;</span><span class="p">:</span> <span class="n">_LIDS</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Main idd parameters</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s1">&#39;--shot&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;shot number&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;username of the DB where the datafile is located&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-u&#39;</span><span class="p">,</span> <span class="s1">&#39;--user&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;database name where the datafile is located&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-db&#39;</span><span class="p">,</span> <span class="s1">&#39;--database&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;database&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;--run&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;run number&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;run&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-v&#39;</span><span class="p">,</span> <span class="s1">&#39;--version&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;version number&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">])</span>

    <span class="c1"># Equilibrium idd parameters</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s_eq&#39;</span><span class="p">,</span> <span class="s1">&#39;--shot_eq&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;shot number for equilibrium, defaults to -s&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;username for the equilibrium, defaults to -u&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-u_eq&#39;</span><span class="p">,</span> <span class="s1">&#39;--user_eq&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;database name for the equilibrium, defaults to -tok&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-db_eq&#39;</span><span class="p">,</span> <span class="s1">&#39;--database_eq&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r_eq&#39;</span><span class="p">,</span> <span class="s1">&#39;--run_eq&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;run number for the equilibrium, defaults to -r&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Profile idd parameters</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s_prof&#39;</span><span class="p">,</span> <span class="s1">&#39;--shot_prof&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;shot number for profiles, defaults to -s&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;username for the profiles, defaults to -u&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-u_prof&#39;</span><span class="p">,</span> <span class="s1">&#39;--user_prof&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;database name for the profiles, defaults to -tok&#39;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-db_prof&#39;</span><span class="p">,</span> <span class="s1">&#39;--database_prof&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r_prof&#39;</span><span class="p">,</span> <span class="s1">&#39;--run_prof&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;run number for the profiles, defaults to -r&#39;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;ids from which to load diagnostics data,&quot;</span>
           <span class="o">+</span> <span class="s2">&quot; can be:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;lids&#39;</span><span class="p">]))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--ids&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;lids&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-B&#39;</span><span class="p">,</span> <span class="s1">&#39;--Brightness&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Whether to express result as brightness&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-res&#39;</span><span class="p">,</span> <span class="s1">&#39;--res&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Space resolution for the LOS-discretization&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t0&#39;</span><span class="p">,</span> <span class="s1">&#39;--t0&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2boolstr</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Reference time event setting t = 0&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-tl&#39;</span><span class="p">,</span> <span class="s1">&#39;--tlim&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2tlim</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;limits of the time interval&#39;</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;tlim&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;--coefs&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Corrective coefficient, if any&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ich&#39;</span><span class="p">,</span> <span class="s1">&#39;--indch&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;indices of channels to be loaded&#39;</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ichauto&#39;</span><span class="p">,</span> <span class="s1">&#39;--indch_auto&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;automatically determine indices &#39;</span>
                              <span class="o">+</span> <span class="s1">&#39;of channels to be loaded&#39;</span><span class="p">),</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;indch_auto&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-e&#39;</span><span class="p">,</span> <span class="s1">&#39;--extra&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;If True loads separatrix and heating power&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-sx&#39;</span><span class="p">,</span> <span class="s1">&#39;--sharex&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Should X axis be shared between diag ids?&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;sharex&#39;</span><span class="p">],</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-if&#39;</span><span class="p">,</span> <span class="s1">&#39;--input_file&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;mat file from which to load core_profiles&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-of&#39;</span><span class="p">,</span> <span class="s1">&#39;--output_file&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;mat file into which to save synthetic signal&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-bck&#39;</span><span class="p">,</span> <span class="s1">&#39;--background&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">_str2bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Plot data enveloppe as grey background ?&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">ddef</span><span class="p">[</span><span class="s1">&#39;bck&#39;</span><span class="p">],</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ddef</span><span class="p">,</span> <span class="n">parser</span></div>


<span class="c1"># #############################################################################</span>
<span class="c1">#       Parser dict</span>
<span class="c1"># #############################################################################</span>


<span class="n">_DPARSER</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">parser_version</span><span class="p">,</span>
    <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">parser_custom</span><span class="p">,</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="n">parser_plot</span><span class="p">,</span>
    <span class="s1">&#39;calc&#39;</span><span class="p">:</span> <span class="n">parser_calc</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2016-2021, Tofu contributors.<br/>
      Last updated on Nov 15, 2021.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>